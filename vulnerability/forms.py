from django import forms

from assets.models import Asset
from company.models import CompanyUser
from vulnerability.models import DefaultVulnerability, UserVulnerability


class DefaultVulnerabilityForm(forms.ModelForm):
    class Meta:
        model=DefaultVulnerability
        fields=['name','related_asset_category']


class UserVulnerabilityForm(forms.ModelForm):
    company = forms.ModelChoiceField(queryset=CompanyUser .objects.none(), required=True)
    related_asset = forms.ModelChoiceField(queryset=Asset.objects.none(), required=True)

    class Meta:
        model = UserVulnerability
        fields = ['name', 'company', 'related_asset']

    def __init__(self, *args, **kwargs):
        super(UserVulnerabilityForm, self).__init__(*args, **kwargs)
        self.fields['company'].queryset = CompanyUser .objects.filter(user=kwargs['initial']['user']).values_list('company', flat=True)



